<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pomodoro Timer</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #f7f7f7;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    #logo {
      width: 150px;
      margin-bottom: 20px;
    }

    .section {
      background-color: white;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      padding: 20px;
      margin-bottom: 20px;
      width: 100%;
      max-width: 360px;
      transition: all 0.3s ease;
    }

    .timer-box {
      font-size: 3em;
      margin: 20px 0;
      background-color: #ffffff;
      padding: 20px;
      border-radius: 12px;
      color: #333;
      text-align: center;
      transition: background-color 0.3s;
    }

    .button {
      box-sizing: border-box;
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      background-color: #FA660F;
      color: white;
      border: 1px solid #FA660F;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      margin: 10px 5px 0 5px;
      transition: background-color 0.2s;
    }

    .button:hover {
      background-color: #e15500;
    }

    #resetBtn {
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    background-color: white;
    border: 1px solid #FB0300;
    color: #FB0300;
    }
    
    #resetBtn:hover {
    background-color: #fff7f2;
    }

    .session-counter {
      margin-top: 10px;
      font-size: 0.95em;
      color: #555;
      text-align: center;
    }

  .customize-button {
    background-color: white;
    border: 1px solid #FA660F;
    border-radius: 10px;
    padding: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    width: 100%;
    margin-top: 10px;
  }
  .customize-button:hover {
    background-color: #fff7f2;
  }

    .content {
      display: none;
      margin-top: 15px;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      align-items: center;
    }

    .settings-grid label {
      grid-column: span 2;
      font-weight: 500;
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .settings-grid input {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1em;
      width: 100%;
      box-sizing: border-box;
    }

    .apply-btn {
      grid-column: span 2;
      margin-top: 10px;
      background-color: #FA660F;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
    }

    #phaseLabel {
      text-align: center;
      font-weight: bold;
      font-size: 1.1em;
      color: #FA660F;
    }

    #popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      display: none;
    }

    #popupContent {
      background: white;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      max-width: 300px;
    }

    #popupContent h2 {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <img id="logo" src="https://images.contentstack.io/v3/assets/bltb564490bc5201f31/bltfca3027a7e89bc13/6787e4768c6f504919511797/strategy_logo_black.svg" alt="Strategy Logo" />

  <div class="section">
    <div id="phaseLabel">Focus</div>
    <div id="timerDisplay" class="timer-box">25:00</div>
    <div style="text-align: center;">
      <button id="startBtn" class="button">Start</button>
      <button id="resetBtn" class="button">Reset</button>
    </div>
    <div id="sessionCounter" class="session-counter">Focus: 0 | Short Breaks: 0 | Long Breaks: 0</div>
  </div>

  <div class="section">
    <button class="customize-button" onclick="toggleSettings()">
  <svg width="20" height="20" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle; margin-right: 8px;">
    <path d="M262.29,192.31a64,64,0,1,0,57.4,57.4A64.13,64.13,0,0,0,262.29,192.31ZM416.39,256a154.34,154.34,0,0,1-1.53,20.79l45.21,35.46A10.81,10.81,0,0,1,462.52,326l-42.77,74a10.81,10.81,0,0,1-13.14,4.59l-44.9-18.08a16.11,16.11,0,0,0-15.17,1.75A164.48,164.48,0,0,1,325,400.8a15.94,15.94,0,0,0-8.82,12.14l-6.73,47.89A11.08,11.08,0,0,1,298.77,470H213.23a11.11,11.11,0,0,1-10.69-8.87l-6.72-47.82a16.07,16.07,0,0,0-9-12.22,155.3,155.3,0,0,1-21.46-12.57,16,16,0,0,0-15.11-1.71l-44.89,18.07a10.81,10.81,0,0,1-13.14-4.58l-42.77-74a10.8,10.8,0,0,1,2.45-13.75l38.21-30a16.05,16.05,0,0,0,6-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16,16,0,0,0-6.07-13.94l-38.19-30A10.81,10.81,0,0,1,49.48,186l42.77-74a10.81,10.81,0,0,1,13.14-4.59l44.9,18.08a16.11,16.11,0,0,0,15.17-1.75A164.48,164.48,0,0,1,187,111.2a15.94,15.94,0,0,0,8.82-12.14l6.73-47.89A11.08,11.08,0,0,1,213.23,42h85.54a11.11,11.11,0,0,1,10.69,8.87l6.72,47.82a16.07,16.07,0,0,0,9,12.22,155.3,155.3,0,0,1,21.46,12.57,16,16,0,0,0,15.11,1.71l44.89-18.07a10.81,10.81,0,0,1,13.14,4.58l42.77,74a10.8,10.8,0,0,1-2.45,13.75l-38.21,30a16.05,16.05,0,0,0-6.05,14.08C416.17,247.67,416.39,251.83,416.39,256Z" style="fill:none;stroke:#FA660F;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/>
  </svg>
  <span style="color: #FA660F; font-weight: bold; font-size: 1em; vertical-align: middle;">Customize</span>
</button>
    <div id="settingsContent" class="content">
      <div class="settings-grid">
        <label for="focusMin">Focus Time:</label>
        <input type="number" id="focusMin" value="25" min="0" />
        <input type="number" id="focusSec" value="0" min="0" max="59" />

        <label for="shortBreakMin">Short Break:</label>
        <input type="number" id="shortBreakMin" value="5" min="0" />
        <input type="number" id="shortBreakSec" value="0" min="0" max="59" />

        <label for="longBreakMin">Long Break:</label>
        <input type="number" id="longBreakMin" value="15" min="0" />
        <input type="number" id="longBreakSec" value="0" min="0" max="59" />

        <label for="pomosUntilLong">Pomodoros Before Long Break:</label>
        <input type="number" id="pomosUntilLong" value="4" min="1" style="grid-column: span 2;" />

        <button class="apply-btn" onclick="applySettings()">Apply</button>
      </div>
    </div>
  </div>

  <div id="popup">
    <div id="popupContent">
      <h2>Congratulations! Let's begin another round?</h2>
      <button class="button" onclick="restartSession()">Let's Go!</button>
      <button class="button" onclick="closePopup()">No, thanks!</button>
    </div>
  </div>

  <script>
    let timer,
      totalSeconds = 0,
      isRunning = false;
    let currentPhase = 'focus',
      focusCount = 0,
      shortBreakCount = 0,
      longBreakCount = 0,
      pomoLimit = 4;

    let settings = {
      focus: { min: 25, sec: 0 },
      shortBreak: { min: 5, sec: 0 },
      longBreak: { min: 15, sec: 0 }
    };

    // Flag to skip short break immediately before long break
    let shouldSkipShortBreak = false;

    function updateDisplay() {
      const minutes = Math.floor(totalSeconds / 60)
        .toString()
        .padStart(2, '0');
      const seconds = (totalSeconds % 60).toString().padStart(2, '0');
      document.getElementById('timerDisplay').textContent = `${minutes}:${seconds}`;
    }

    function toggleSettings() {
      const content = document.getElementById('settingsContent');
      content.style.display = content.style.display === 'block' ? 'none' : 'block';
    }

    function applySettings() {
      settings.focus.min = parseInt(document.getElementById('focusMin').value) || 0;
      settings.focus.sec = parseInt(document.getElementById('focusSec').value) || 0;
      settings.shortBreak.min = parseInt(document.getElementById('shortBreakMin').value) || 0;
      settings.shortBreak.sec = parseInt(document.getElementById('shortBreakSec').value) || 0;
      settings.longBreak.min = parseInt(document.getElementById('longBreakMin').value) || 0;
      settings.longBreak.sec = parseInt(document.getElementById('longBreakSec').value) || 0;
      pomoLimit = parseInt(document.getElementById('pomosUntilLong').value) || 4;
      setPhase('focus');
      updateSessionCounter();
    }

    function setPhase(phase) {
      currentPhase = phase;
      document.getElementById('phaseLabel').textContent =
        phase === 'focus'
          ? 'Focus'
          : phase === 'shortBreak'
          ? 'Short Break'
          : 'Long Break';

      const time = settings[phase];
      totalSeconds = time.min * 60 + time.sec;
      updateDisplay();
      updateTimerColor();
    }

    function updateTimerColor() {
      const timerBox = document.getElementById('timerDisplay');
      if (currentPhase === 'focus') {
        timerBox.style.backgroundColor = '#ffffff';
        timerBox.style.color = '#333';
      } else {
        timerBox.style.backgroundColor = '#FA660F';
        timerBox.style.color = 'white';
      }
    }

    function nextPhase() {
      if (currentPhase === 'focus') {
        focusCount++;
        if (focusCount % pomoLimit === 0) {
          setPhase('longBreak');
          shouldSkipShortBreak = true; // Set flag to skip next short break
        } else {
          setPhase('shortBreak');
        }
      } else if (currentPhase === 'shortBreak') {
        shortBreakCount++;
        setPhase('focus');
      } else if (currentPhase === 'longBreak') {
        longBreakCount++;
        clearInterval(timer);
        isRunning = false;
        document.getElementById('startBtn').textContent = 'Start';
        showPopup();
        return;
      }
      updateSessionCounter();

      // If flagged to skip short break, do so now by advancing phase immediately
      if (shouldSkipShortBreak && currentPhase === 'shortBreak') {
        shouldSkipShortBreak = false;
        nextPhase(); // Skip short break phase and move on to focus
      } else {
        startTimer();
      }
    }

    function updateSessionCounter() {
      document.getElementById(
        'sessionCounter'
      ).textContent = `Focus: ${focusCount} | Short Breaks: ${shortBreakCount} | Long Breaks: ${longBreakCount}`;
    }

    function startTimer() {
      if (isRunning) return;
      isRunning = true;
      document.getElementById('startBtn').textContent = 'Pause';

      timer = setInterval(() => {
        if (totalSeconds > 0) {
          totalSeconds--;
          updateDisplay();
        } else {
          clearInterval(timer);
          isRunning = false;
          document.getElementById('startBtn').textContent = 'Start';
          nextPhase();
        }
      }, 1000);
    }

    function pauseTimer() {
      if (!isRunning) return;
      clearInterval(timer);
      isRunning = false;
      document.getElementById('startBtn').textContent = 'Start';
    }

function resetTimer() {
  pauseTimer();
  shouldSkipShortBreak = false;
  setPhase('focus');
  updateSessionCounter();
  closePopup();
}

    function toggleStartPause() {
      if (isRunning) {
        pauseTimer();
      } else {
        startTimer();
      }
    }

    function showPopup() {
      document.getElementById('popup').style.display = 'flex';
    }

function closePopup() {
  document.getElementById('popup').style.display = 'none';
  pauseTimer();
  setPhase('focus'); // reset timer display but keep stats
}

function restartSession() {
  resetTimer();
  closePopup();
  startTimer();
}

    // Initialize timer display and counters on load
    window.onload = () => {
      setPhase('focus');
      updateSessionCounter();
    };

    document.getElementById('startBtn').addEventListener('click', toggleStartPause);
    document.getElementById('resetBtn').addEventListener('click', resetTimer);
  </script>
</body>
</html>
